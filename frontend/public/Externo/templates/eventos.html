<!DOCTYPE html>
<html lang="es" class="theme-dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eventos - LuckasEnt</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="/external/static/css/main.css">
    <link rel="stylesheet" href="/external/static/css/eventos.css">
    <style>
        /* Modal de detalles del evento */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-container {
            background-color: var(--surface);
            border-radius: 12px;
            max-width: 900px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.show .modal-container {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .modal-header h3 {
            font-size: 1.5rem;
            color: var(--text);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.8rem;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .modal-close:hover {
            color: var(--text);
        }

        .modal-body {
            padding: 1rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Contenedor de detalles del evento */
        .event-details-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        /* Panel principal con detalles */
        .event-details-main {
            background-color: rgba(18, 18, 18, 0.8);
            border-radius: 12px;
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        /* Imagen de portada */
        .event-cover {
            height: 280px;
            position: relative;
        }

        .event-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .event-cover-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.8) 0%, transparent 100%);
            padding: 2rem;
            padding-top: 6rem;
        }

        .event-cover-overlay h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .event-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .event-tag {
            background-color: rgba(106, 133, 182, 0.2);
            color: var(--blue-light);
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .event-info-container {
            padding: 2rem;
        }

        .event-info-section {
            margin-bottom: 2rem;
        }

        .event-info-section:last-child {
            margin-bottom: 0;
        }

        .event-info-section h3 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border);
        }

        .event-description-full {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .event-description-full p {
            margin-bottom: 1rem;
        }

        /* Programa del evento */
        .event-schedule {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .schedule-item {
            display: flex;
            padding: 1rem;
            background-color: rgba(30, 30, 40, 0.5);
            border-radius: 8px;
            gap: 1rem;
        }

        .schedule-time {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 80px;
            color: var(--blue-light);
        }

        .schedule-time-start {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .schedule-time-end {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .schedule-content {
            flex-grow: 1;
        }

        .schedule-title {
            font-size: 1.1rem;
            margin-bottom: 0.3rem;
        }

        .schedule-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Ubicación */
        .location-info {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .location-address {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .location-address i {
            color: var(--blue-light);
            margin-top: 0.2rem;
            font-size: 1.2rem;
        }

        .location-address-text {
            color: var(--text-secondary);
        }

        .location-address-text p {
            margin-bottom: 0.3rem;
        }

        .location-map {
            height: 200px;
            background-color: rgba(30, 30, 40, 0.5);
            border-radius: 8px;
            overflow: hidden;
        }

        .location-map iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Sidebar con información adicional */
        .event-details-sidebar {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .event-actions {
            background-color: rgba(18, 18, 18, 0.8);
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .event-actions h3 {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border);
        }

        .event-price-large {
            display: flex;
            align-items: baseline;
            margin-bottom: 1.5rem;
        }

        .event-price-large-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--blue-light);
        }

        .event-price-large-text {
            margin-left: 0.5rem;
            color: var(--text-secondary);
        }

        .ticket-selector {
            margin-bottom: 1.5rem;
        }

        .ticket-selector label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .ticket-counter {
            display: flex;
            align-items: center;
            background-color: rgba(30, 30, 40, 0.5);
            border-radius: 8px;
            overflow: hidden;
        }

        .ticket-button {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s ease;
        }

        .ticket-button:hover {
            background-color: rgba(106, 133, 182, 0.1);
            color: var(--blue-light);
        }

        .ticket-count {
            flex-grow: 1;
            text-align: center;
            font-weight: 500;
        }

        .action-button {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            text-decoration: none;
        }

        .action-button.primary {
            background-color: var(--blue-medium);
            color: var(--white);
        }

        .action-button.primary:hover {
            background-color: var(--blue-medium-dark);
            box-shadow: 0 0 15px rgba(106, 133, 182, 0.3);
            transform: translateY(-2px);
        }

        .action-button.secondary {
            background-color: rgba(30, 30, 40, 0.5);
            color: var(--text);
        }

        .action-button.secondary:hover {
            background-color: rgba(50, 50, 60, 0.5);
        }

        .event-details {
            background-color: rgba(18, 18, 18, 0.8);
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .event-details h3 {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border);
        }

        .event-detail-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .event-detail-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .event-detail-icon {
            width: 40px;
            height: 40px;
            background-color: rgba(30, 30, 40, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .event-detail-icon i {
            color: var(--blue-light);
            font-size: 1.1rem;
        }

        .event-detail-content {
            flex-grow: 1;
        }

        .event-detail-label {
            font-weight: 500;
            margin-bottom: 0.2rem;
        }

        .event-detail-value {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Información del organizador */
        .organizer-info {
            background-color: rgba(18, 18, 18, 0.8);
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            gap: 1rem;
        }

        .organizer-image {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
        }

        .organizer-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .organizer-details {
            flex-grow: 1;
        }

        .organizer-name {
            font-weight: 500;
            margin-bottom: 0.3rem;
        }

        .organizer-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .organizer-contact {
            display: flex;
            gap: 0.5rem;
        }

        .organizer-contact-button {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: rgba(30, 30, 40, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--blue-light);
            transition: all 0.2s ease;
        }

        .organizer-contact-button:hover {
            background-color: rgba(106, 133, 182, 0.2);
            transform: translateY(-3px);
        }

        /* Responsividad del modal */
        @media (max-width: 992px) {
            .event-details-container {
                grid-template-columns: 1fr;
            }
            
            .event-cover {
                height: 220px;
            }
        }

        @media (max-width: 768px) {
            .schedule-item {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .schedule-time {
                flex-direction: row;
                gap: 0.5rem;
                justify-content: flex-start;
                min-width: auto;
            }
            
            .organizer-info {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .modal-container {
                width: 95%;
                max-height: 95vh;
            }
        }
    </style>
</head>
<body>
    <!-- El resto del contenido HTML es igual que antes -->
    <!-- Fondo de ondas animadas -->
    <div class="wave-background">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
    </div>

    <div class="app-container">
        <!-- Sidebar elegante -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="/external/static/img/lOGO%20PROYECTO%20LuckasEnt.png" alt="Logo LuckasEnt" class="logo">
                <h1>Luckas</h1>
            </div>
            <div class="user-profile">
                <div class="user-image-container">
                    <img src="/external/static/img/meme.jpg" alt="Perfil de usuario" class="user-image">
                </div>
                <div class="user-info">
                    <h3 id="user-name">Juan Pérez</h3>
                    <p id="user-role">Estudiante</p>
                </div>
            </div>
            <nav class="main-nav">
                <div class="nav-section">
                    <h4>Principal</h4>
                    <ul>
                        <li>
                            <a href="dashboard.html">
                                <i class="fas fa-th-large"></i>
                                <span>Panel Principal</span>
                            </a>
                        </li>
                        <li>
                            <a href="perfil.html">
                                <i class="fas fa-user"></i>
                                <span>Mi Perfil</span>
                            </a>
                        </li>
                        <li>
                            <a href="notificaciones.html">
                                <i class="fas fa-bell"></i>
                                <span>Notificaciones</span>
                                <span class="badge">3</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h4>Gestión</h4>
                    <ul>
                        <li class="active">
                            <a href="eventos.html">
                                <i class="fas fa-calendar-alt"></i>
                                <span>Eventos</span>
                            </a>
                        </li>
                        <li>
                            <a href="programas-academicos.html">
                                <i class="fas fa-graduation-cap"></i>
                                <span>Programas Académicos</span>
                            </a>
                        </li>
                        <li>
                            <a href="cabanas.html">
                                <i class="fas fa-home"></i>
                                <span>Reservas de Cabañas</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h4>Cuenta</h4>
                    <ul>
                        <li>
                            <a href="configuracion.html">
                                <i class="fas fa-cog"></i>
                                <span>Configuración</span>
                            </a>
                        </li>
                        <li>
                            <a href="ayuda.html">
                                <i class="fas fa-question-circle"></i>
                                <span>Ayuda</span>
                            </a>
                        </li>
                        <li>
                            <a href="index.html" class="logout">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Cerrar Sesión</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
            <div class="sidebar-footer">
                <p>Seminario Bautista de Colombia</p>
                <p class="version">Luckas v2.1.0</p>
            </div>
        </aside>

        <!-- Contenido principal -->
        <main class="main-content">
            <h2>Eventos</h2>
            <div id="eventos-list" class="events-grid"></div>
        </main>
    </div>
    
    <!-- Modal de detalles del evento -->
    <div class="modal-overlay" id="event-details-modal">
        <div class="modal-container">
            <div class="modal-header">
                <h3>Detalles del Evento</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="event-details-container">
                    <!-- Información principal del evento -->
                    <div class="event-details-main">
                        <div class="event-cover">
                            <img id="modal-event-image" src="images/events/conference.jpg" alt="Evento">
                            <div class="event-cover-overlay">
                                <h2 id="modal-event-title">Conferencia de Teología</h2>
                                <div class="event-tags">
                                    <div class="event-tag" id="modal-event-category">Conferencia</div>
                                    <div class="event-tag">Teología</div>
                                    <div class="event-tag">Formación</div>
                                </div>
                            </div>
                        </div>
                        <div class="event-info-container">
                            <!-- Descripción -->
                            <div class="event-info-section">
                                <h3>Descripción</h3>
                                <div class="event-description-full" id="modal-event-description">
                                    <p>La Conferencia de Teología del Seminario Bautista de Colombia es un evento dedicado al estudio profundo de la teología bíblica con expertos en la materia. Durante esta jornada intensiva, exploraremos temas fundamentales de la doctrina cristiana desde una perspectiva bautista conservadora.</p>
                                    <p>Los participantes tendrán la oportunidad de profundizar en el conocimiento bíblico, fortalecer sus fundamentos teológicos y desarrollar herramientas para la aplicación de estos principios en su ministerio y vida cotidiana.</p>
                                </div>
                            </div>
                            
                            <!-- Programa -->
                            <div class="event-info-section">
                                <h3>Programa</h3>
                                <div class="event-schedule" id="modal-event-schedule">
                                    <div class="schedule-item">
                                        <div class="schedule-time">
                                            <div class="schedule-time-start">9:00</div>
                                            <div class="schedule-time-end">10:30</div>
                                        </div>
                                        <div class="schedule-content">
                                            <div class="schedule-title">Fundamentos de Hermenéutica</div>
                                            <div class="schedule-description">Principios para una correcta interpretación de las Escrituras en el contexto contemporáneo</div>
                                        </div>
                                    </div>
                                    <div class="schedule-item">
                                        <div class="schedule-time">
                                            <div class="schedule-time-start">10:45</div>
                                            <div class="schedule-time-end">12:15</div>
                                        </div>
                                        <div class="schedule-content">
                                            <div class="schedule-title">Cristología Aplicada</div>
                                            <div class="schedule-description">La persona y obra de Cristo como centro de la teología</div>
                                        </div>
                                    </div>
                                    <div class="schedule-item">
                                        <div class="schedule-time">
                                            <div class="schedule-time-start">12:15</div>
                                            <div class="schedule-time-end">13:30</div>
                                        </div>
                                        <div class="schedule-content">
                                            <div class="schedule-title">Almuerzo</div>
                                            <div class="schedule-description">Tiempo para compartir y networking</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Ubicación -->
                            <div class="event-info-section">
                                <h3>Ubicación</h3>
                                <div class="location-info">
                                    <div class="location-address">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <div class="location-address-text" id="modal-event-location">
                                            <p>Auditorio Principal</p>
                                            <p>Seminario Bautista de Colombia</p>
                                            <p>Carrera 45 #50-12, Bogotá</p>
                                        </div>
                                    </div>
                                    <div class="location-map">
                                        <iframe id="modal-event-map" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3976.8101263330753!2d-74.09626638573687!4d4.6506096964083965!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zNMKwMzknMDIuMiJOIDc0wrAwNSc0Ni42Ilc!5e0!3m2!1ses!2sco!4v1620000000000!5m2!1ses!2sco" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sidebar con información adicional -->
                    <div class="event-details-sidebar">
                        <!-- Acciones de evento -->
                        <div class="event-actions">
                            <h3>Inscripción</h3>
                            <div class="event-price-large">
                                <div class="event-price-large-value" id="modal-event-price">$150.000</div>
                                <div class="event-price-large-text">por persona</div>
                            </div>
                            <div class="ticket-selector">
                                <label>Número de participantes:</label>
                                <div class="ticket-counter">
                                    <button class="ticket-button" id="decrease-tickets">-</button>
                                    <div class="ticket-count" id="ticket-count">1</div>
                                    <button class="ticket-button" id="increase-tickets">+</button>
                                </div>
                            </div>
                            <a href="{{ url_for('inscripcion') }}" class="action-button primary" id="register-btn">
                                <i class="fas fa-user-plus"></i> Inscribirme ahora
                            </a>
                            <button class="action-button secondary">
                                <i class="fas fa-share-alt"></i> Compartir evento
                            </button>
                        </div>
                        
                        <!-- Detalles adicionales -->
                        <div class="event-details">
                            <h3>Detalles del evento</h3>
                            <div class="event-detail-item">
                                <div class="event-detail-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div class="event-detail-content">
                                    <div class="event-detail-label">Fecha</div>
                                    <div class="event-detail-value" id="modal-event-date">16 de mayo, 2025</div>
                                </div>
                            </div>
                            <div class="event-detail-item">
                                <div class="event-detail-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="event-detail-content">
                                    <div class="event-detail-label">Hora</div>
                                    <div class="event-detail-value" id="modal-event-time">9:00 AM - 5:00 PM</div>
                                </div>
                            </div>
                            <div class="event-detail-item">
                                <div class="event-detail-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="event-detail-content">
                                    <div class="event-detail-label">Cupos disponibles</div>
                                    <div class="event-detail-value" id="modal-event-capacity">45 de 120</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Información del organizador -->
                        <div class="organizer-info">
                            <div class="organizer-image">
                                <img src="images/organizer.jpg" alt="Organizador">
                            </div>
                            <div class="organizer-details">
                                <h4 class="organizer-name" id="modal-event-organizer">Facultad de Teología</h4>
                                <p class="organizer-description">Departamento académico encargado de la formación teológica en el Seminario Bautista de Colombia.</p>
                                <div class="organizer-contact">
                                    <a href="mailto:teologia@sbc.edu.co" class="organizer-contact-button"><i class="fas fa-envelope"></i></a>
                                    <a href="https://sbc.edu.co" class="organizer-contact-button"><i class="fas fa-globe"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="close-details-btn">Cerrar</button>
                <a href="/external/inscripcion.html" class="btn btn-primary" id="modal-register-link">Inscribirme ahora</a>
            </div>
        </div>
    </div>

<script>
    // Cargar eventos desde la API y mostrarlos
    let eventosGlobal = [];
    async function cargarEventos() {
        try {
            const response = await fetch('/api/external/eventos');
            const eventos = await response.json();
            eventosGlobal = eventos;
            const contenedor = document.getElementById('eventos-list');
            contenedor.innerHTML = '';
            if (!Array.isArray(eventos) || eventos.length === 0) {
                contenedor.innerHTML = '<p>No hay eventos disponibles.</p>';
                return;
            }
            eventos.forEach((evento, idx) => {
                const card = document.createElement('div');
                card.className = 'event-card';
                card.innerHTML = `
                    <div class="event-cover">
                        <img src="/external/static/img/evento-default.jpg" alt="Evento">
                    </div>
                    <div class="event-info-container">
                        <h3>${evento.name || evento.nombre}</h3>
                        <p>${evento.description || evento.descripcion || ''}</p>
                        <span class="event-tag">${evento.categoria?.nombre || 'Sin categoría'}</span>
                        <p><b>Precio:</b> $${evento.price?.toLocaleString() || evento.precio?.toLocaleString() || '0'}</p>
                    </div>
                `;
                card.style.cursor = 'pointer';
                card.addEventListener('click', () => mostrarDetallesEvento(idx));
                contenedor.appendChild(card);
            });
        } catch (err) {
            document.getElementById('eventos-list').innerHTML = '<p>Error al cargar eventos.</p>';
        }
    }

    // Mostrar detalles del evento en el modal
    function mostrarDetallesEvento(idx) {
        const evento = eventosGlobal[idx];
        if (!evento) return;
        document.getElementById('modal-event-title').textContent = evento.name || evento.nombre || '';
        document.getElementById('modal-event-category').textContent = evento.categoria?.nombre || 'Sin categoría';
        document.getElementById('modal-event_description').innerHTML = `<p>${evento.description || evento.descripcion || ''}</p>`;
        document.getElementById('modal-event-price').textContent = `$${(evento.price || evento.precio || 0).toLocaleString()}`;
        document.getElementById('modal-event-date').textContent = evento.fecha || evento.date || 'Por definir';
        document.getElementById('modal-event-time').textContent = evento.hora || evento.time || 'Por definir';
        document.getElementById('modal-event-capacity').textContent = evento.cupos ? `${evento.cupos} disponibles` : 'Por definir';
        document.getElementById('modal-event-organizer').textContent = evento.organizador || 'Organizador';
        // Imagen de portada (si hay)
        const img = document.getElementById('modal-event-image');
        img.src = evento.imagen || '/external/static/img/evento-default.jpg';
        // Ubicación
        document.getElementById('modal-event-location').innerHTML = evento.ubicacion || '<p>Por definir</p>';
        // Mapa (si hay lat/lng o url)
        if (evento.mapa) {
            document.getElementById('modal-event-map').src = evento.mapa;
        }
        // Programa (si hay)
        const scheduleDiv = document.getElementById('modal-event-schedule');
        if (Array.isArray(evento.programa)) {
            scheduleDiv.innerHTML = evento.programa.map(item => `
                <div class="schedule-item">
                    <div class="schedule-time">
                        <div class="schedule-time-start">${item.inicio || ''}</div>
                        <div class="schedule-time-end">${item.fin || ''}</div>
                    </div>
                    <div class="schedule-content">
                        <div class="schedule-title">${item.titulo || ''}</div>
                        <div class="schedule-description">${item.descripcion || ''}</div>
                    </div>
                </div>
            `).join('');
        }
        // Mostrar modal
        document.getElementById('event-details-modal').classList.add('show');
        // Actualizar link de inscripción
        document.getElementById('modal-register-link').href = `/external/inscripcion.html?evento=${encodeURIComponent(evento._id || evento.id || idx)}`;
    }

    // Cerrar modal
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('close-details-btn').onclick = function() {
            document.getElementById('event-details-modal').classList.remove('show');
        };
        document.querySelector('.modal-close').onclick = function() {
            document.getElementById('event-details-modal').classList.remove('show');
        };
        // Cargar nombre y rol dinámicamente
        const userName = localStorage.getItem('userName') || 'Juan Pérez';
        const userRole = localStorage.getItem('userRole') || 'Estudiante';
        const userNameElem = document.getElementById('user-name');
        const userRoleElem = document.getElementById('user-role');
        if (userNameElem) userNameElem.textContent = userName;
        if (userRoleElem) userRoleElem.textContent = userRole;
    });
    window.onload = cargarEventos;
</script>
</body>
</html>